% Style to select only points from #1 to #2 (inclusive)
\pgfplotsset
{
	select coords between index/.style 2 args=
	{
    x filter/.code=
		{
        \ifnum\coordindex<#1\def\pgfmathresult{}\fi
        \ifnum\coordindex>#2\def\pgfmathresult{}\fi
    }
	}
}
\begin{figure}[h]
\centering
%% \large
\begin{tikzpicture}[scale=0.9, transform shape]
	\begin{groupplot}[group style={group size= 3 by 3,vertical sep=0.75cm},height=3cm,width=4cm,xmode=log,log basis x={2},max space between ticks=20,minor tick num=1,tick label style={font=\tiny},xlabel style={font=\tiny},ylabel style={font=\tiny}, title style={font=\tiny}]
		\nextgroupplot[title=small,ylabel={Read-Dominated},xtick=data]
				\addplot[red,semithick,mark=triangle] 	[select coords between index={3}{6}] table[x=keyspace, y=MOPS, col sep=tab] {Data/HJ-BST-Keysweep.csv};  \label{plots:HJ-BST-K}
				\addplot[blue,semithick,mark=asterisk]  [select coords between index={3}{6}] table[x=keyspace, y=MOPS, col sep=tab] {Data/NM-BST-Keysweep.csv};  \label{plots:NM-BST-K}
				\addplot[brown, semithick,mark=square]  [select coords between index={3}{6}] table[x=keyspace, y=MOPS, col sep=tab] {Data/CITRUS-Keysweep.csv};  \label{plots:CITRUS-K}
				\addplot[green, semithick,mark=o] 			[select coords between index={3}{6}] table[x=keyspace, y=MOPS, col sep=tab] {Data/RM-BST-Keysweep.csv};  \label{plots:RM-BST-K}
				\coordinate (top) at (rel axis cs:0,1);% coordinate at top of the first plot
		\nextgroupplot[title=Medium,xtick=data]
				\addplot[red,semithick,mark=triangle] 	[select coords between index={7}{10}] table[x=keyspace, y=MOPS, col sep=tab] {Data/HJ-BST-Keysweep.csv};
				\addplot[blue,semithick,mark=asterisk] 	[select coords between index={7}{10}] table[x=keyspace, y=MOPS, col sep=tab] {Data/NM-BST-Keysweep.csv};
				\addplot[brown, semithick,mark=square]  [select coords between index={7}{10}] table[x=keyspace, y=MOPS, col sep=tab] {Data/CITRUS-Keysweep.csv};
				\addplot[green, semithick,mark=o] 			[select coords between index={7}{10}] table[x=keyspace, y=MOPS, col sep=tab] {Data/RM-BST-Keysweep.csv};
		\nextgroupplot[title=Large,xtick=data]
				\addplot[red,semithick,mark=triangle] 	[select coords between index={11}{14}] table[x=keyspace, y=MOPS, col sep=tab] {Data/HJ-BST-Keysweep.csv};
				\addplot[blue,semithick,mark=asterisk] 	[select coords between index={11}{14}] table[x=keyspace, y=MOPS, col sep=tab] {Data/NM-BST-Keysweep.csv};
				\addplot[brown, semithick,mark=square]  [select coords between index={11}{14}] table[x=keyspace, y=MOPS, col sep=tab] {Data/CITRUS-Keysweep.csv};
				\addplot[green, semithick,mark=o] 			[select coords between index={11}{14}] table[x=keyspace, y=MOPS, col sep=tab] {Data/RM-BST-Keysweep.csv};
		\nextgroupplot[ylabel={Mixed},xtick=data]
				\addplot[red,semithick,mark=triangle] 	[select coords between index={18}{21}] table[x=keyspace, y=MOPS, col sep=tab] {Data/HJ-BST-Keysweep.csv};
				\addplot[blue,semithick,mark=asterisk] 	[select coords between index={18}{21}] table[x=keyspace, y=MOPS, col sep=tab] {Data/NM-BST-Keysweep.csv};
				\addplot[brown, semithick,mark=square]  [select coords between index={18}{21}] table[x=keyspace, y=MOPS, col sep=tab] {Data/CITRUS-Keysweep.csv};
				\addplot[green, semithick,mark=o] 			[select coords between index={18}{21}] table[x=keyspace, y=MOPS, col sep=tab] {Data/RM-BST-Keysweep.csv};
		\nextgroupplot[xtick=data]
				\addplot[red,semithick,mark=triangle] 	[select coords between index={22}{25}] table[x=keyspace, y=MOPS, col sep=tab] {Data/HJ-BST-Keysweep.csv};
				\addplot[blue,semithick,mark=asterisk] 	[select coords between index={22}{25}] table[x=keyspace, y=MOPS, col sep=tab] {Data/NM-BST-Keysweep.csv};
				\addplot[brown, semithick,mark=square]  [select coords between index={22}{25}] table[x=keyspace, y=MOPS, col sep=tab] {Data/CITRUS-Keysweep.csv};
				\addplot[green, semithick,mark=o] 			[select coords between index={22}{25}] table[x=keyspace, y=MOPS, col sep=tab] {Data/RM-BST-Keysweep.csv};
		\nextgroupplot[xtick=data]
				\addplot[red,semithick,mark=triangle] 	[select coords between index={26}{29}] table[x=keyspace, y=MOPS, col sep=tab] {Data/HJ-BST-Keysweep.csv};
				\addplot[blue,semithick,mark=asterisk] 	[select coords between index={26}{29}] table[x=keyspace, y=MOPS, col sep=tab] {Data/NM-BST-Keysweep.csv};
				\addplot[brown, semithick,mark=square]  [select coords between index={26}{29}] table[x=keyspace, y=MOPS, col sep=tab] {Data/CITRUS-Keysweep.csv};
				\addplot[green, semithick,mark=o] 			[select coords between index={26}{29}] table[x=keyspace, y=MOPS, col sep=tab] {Data/RM-BST-Keysweep.csv};	
		\nextgroupplot[xlabel={Key space size},ylabel={Write-Dominated},xtick=data]
				\addplot[red,semithick,mark=triangle] 	[select coords between index={33}{36}] table[x=keyspace, y=MOPS, col sep=tab] {Data/HJ-BST-Keysweep.csv};
				\addplot[blue,semithick,mark=asterisk] 	[select coords between index={33}{36}] table[x=keyspace, y=MOPS, col sep=tab] {Data/NM-BST-Keysweep.csv};
				\addplot[brown, semithick,mark=square]  [select coords between index={33}{36}] table[x=keyspace, y=MOPS, col sep=tab] {Data/CITRUS-Keysweep.csv};
				\addplot[green, semithick,mark=o] 			[select coords between index={33}{36}] table[x=keyspace, y=MOPS, col sep=tab] {Data/RM-BST-Keysweep.csv};
		\nextgroupplot[xlabel={Key space size},xtick=data]
				\addplot[red,semithick,mark=triangle] 	[select coords between index={37}{40}] table[x=keyspace, y=MOPS, col sep=tab] {Data/HJ-BST-Keysweep.csv};
				\addplot[blue,semithick,mark=asterisk] 	[select coords between index={37}{40}] table[x=keyspace, y=MOPS, col sep=tab] {Data/NM-BST-Keysweep.csv};
				\addplot[brown, semithick,mark=square]  [select coords between index={37}{40}] table[x=keyspace, y=MOPS, col sep=tab] {Data/CITRUS-Keysweep.csv};
				\addplot[green, semithick,mark=o] 			[select coords between index={37}{40}] table[x=keyspace, y=MOPS, col sep=tab] {Data/RM-BST-Keysweep.csv};
		\nextgroupplot[xlabel={Key space size},xtick=data]
				\addplot[red,semithick,mark=triangle] 	[select coords between index={41}{44}] table[x=keyspace, y=MOPS, col sep=tab] {Data/HJ-BST-Keysweep.csv}; 
				\addplot[blue,semithick,mark=asterisk] 	[select coords between index={41}{44}] table[x=keyspace, y=MOPS, col sep=tab] {Data/NM-BST-Keysweep.csv}; 
				\addplot[brown, semithick,mark=square]  [select coords between index={41}{44}] table[x=keyspace, y=MOPS, col sep=tab] {Data/CITRUS-Keysweep.csv};
				\addplot[green, semithick,mark=o] 			[select coords between index={41}{44}] table[x=keyspace, y=MOPS, col sep=tab] {Data/RM-BST-Keysweep.csv}; 	
				\coordinate (bot) at (rel axis cs:1,0);% coordinate at bottom of the last plot
	\end{groupplot}
	\path (top-|current bounding box.west)-- node[anchor=south,rotate=90] {\tiny Relative throughput (million operations/second)} (bot-|current bounding box.west);
	%\node[right,rotate=90] at (-1.4,-7.2){\small ~Throughput (million ops/sec)};
	\path (top|-current bounding box.north)-- coordinate(legendpos) (bot|-current bounding box.north);
	\matrix[matrix of nodes, anchor=south, draw, inner sep=0.2em, draw] at ([yshift=1ex]legendpos)
  {
    \ref{plots:HJ-BST-K}& \tiny HJ-BST &[3pt]
    \ref{plots:NM-BST-K}& \tiny NM-BST &[3pt]
		\ref{plots:CITRUS-K}& \tiny CITRUS &[3pt]
    \ref{plots:RM-BST-K}& \tiny RM-BST \\
	};
\end{tikzpicture}
\end{figure}